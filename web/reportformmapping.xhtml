<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./layout.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <ui:define name="metadata">
        <f:metadata>
            <f:event listener="#{report_formBean.init()}" type="preRenderView" />
            <f:event listener="#{report_formBean.initializelist()}" type="preRenderView" />
            <f:event listener="#{report_form_entityBean.init()}" type="preRenderView" />
            <f:event listener="#{report_form_entityBean.initializelist()}" type="preRenderView" />
        </f:metadata>
    </ui:define>

    <ui:define name="content">
        <h:form rendered="#{loginBean.IsAllowed(0, 'View')}">
            <p:growl id="messages" showDetail="true" />
            <p:panelGrid columns="2">
                <p:fieldset legend="Report Form Mapping">
                    <p:panelGrid id="pnlFilter" columns="3">
                        <p:outputLabel value="Report Form:" for="report_form2"/>
                        <p:selectOneMenu id="report_form2" value="#{report_form_entityBean.report_formObj}" style="width:125px" converter="report_formConverter">
                            <f:selectItem itemLabel="" />
                            <f:selectItems value="#{report_formBean.tsActive}" var="item" itemLabel="#{item.report_form_name}" itemValue="#{item}"/>
                            <p:ajax process="@this" update="@form"/>
                        </p:selectOneMenu>
                        <p:commandButton value="RETRIEVE ENTITIES" icon="ui-icon-cancel" action="#{report_form_entityBean.refreshReport_form_entityList(report_form_entityBean.report_formObj)}" update="@form" process="@this"/>
                    </p:panelGrid>
                    <p:panelGrid id="pnlRetrieved" columns="3">
                        <p:outputLabel value=""/>
                        <p:outputLabel value=""/>
                        <h:selectBooleanCheckbox id="all_allow_view" value="#{report_form_entityBean.all_allow}">
                            <f:ajax listener="#{report_form_entityBean.All_allow(report_form_entityBean.all_allow)}" render="pnlRetrieved"/>
                        </h:selectBooleanCheckbox>
                        <p:outputLabel value="Entity type" style="font-weight: bold"/>
                        <p:outputLabel value="Entity Name" style="font-weight: bold"/>
                        <p:outputLabel value="Reporting" style="font-weight: bold"/>
                        <c:forEach var="var" items="#{report_form_entityBean.report_form_entityList}" >
                            <p:outputLabel value="#{var.entity_type}"/>
                            <p:outputLabel value="#{var.entity_id}"/>
                            <h:selectBooleanCheckbox>
                                <f:ajax event="change" render="@this"/>
                            </h:selectBooleanCheckbox>
                        </c:forEach>
                    </p:panelGrid>
                    <p:panelGrid id="pnlButtons" columns="2">
                        <p:commandButton value="SAVE" action="#{report_form_entityBean.saveReport_form_entity(loginBean.user_detail.user_detail_id)}" icon="ui-icon-disk" process="pnlFilter,pnlRetrieved" update="@form"/>
                        <p:commandButton value="CLEAR" icon="ui-icon-cancel" action="#{report_form_entityBean.cancel()}" update="@form" process="@this"/>
                    </p:panelGrid>
                </p:fieldset>
            </p:panelGrid>
        </h:form>
    </ui:define>

</ui:composition>
